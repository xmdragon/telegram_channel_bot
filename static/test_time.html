<!DOCTYPE html>
<html>
<head>
    <title>时间测试</title>
    <meta charset="utf-8">
</head>
<body>
    <h1>时间处理测试</h1>
    <div id="result"></div>
    
    <script>
        // 测试时间字符串（来自API）
        const apiTime = '2025-08-12T04:56:22+00:00';
        
        // 解析时间
        const date = new Date(apiTime);
        const now = new Date();
        
        // 计算差值
        const diff = now - date;
        const hours = diff / 3600000;
        const minutes = diff / 60000;
        
        // 显示结果
        const html = `
            <h2>测试结果：</h2>
            <p>API时间字符串: ${apiTime}</p>
            <p>解析后的Date对象: ${date.toString()}</p>
            <p>解析后的ISO字符串: ${date.toISOString()}</p>
            <p>本地时间显示: ${date.toLocaleString()}</p>
            <p>当前时间: ${now.toString()}</p>
            <p>当前时间ISO: ${now.toISOString()}</p>
            <p>时间差（毫秒）: ${diff}</p>
            <p>时间差（小时）: ${hours.toFixed(1)}</p>
            <p>时间差（分钟）: ${minutes.toFixed(0)}</p>
            <hr>
            <h3>使用Utils.formatTime函数：</h3>
        `;
        
        document.getElementById('result').innerHTML = html;
        
        // 测试formatTime函数
        function formatTime(dateString) {
            if (!dateString) return '';
            
            try {
                const date = new Date(dateString);
                const now = new Date();
                const diff = now - date;
                
                console.log('formatTime调试:');
                console.log('  输入:', dateString);
                console.log('  解析后:', date);
                console.log('  当前时间:', now);
                console.log('  差值(ms):', diff);
                console.log('  差值(小时):', diff / 3600000);
                
                if (diff < 60000) return '刚刚';
                if (diff < 3600000) return `${Math.floor(diff / 60000)}分钟前`;
                if (diff < 86400000) return `${Math.floor(diff / 3600000)}小时前`;
                if (diff < 604800000) return `${Math.floor(diff / 86400000)}天前`;
                
                return date.toLocaleDateString('zh-CN', {
                    year: 'numeric',
                    month: '2-digit',
                    day: '2-digit',
                    hour: '2-digit',
                    minute: '2-digit'
                });
            } catch (error) {
                return dateString;
            }
        }
        
        const formatted = formatTime(apiTime);
        document.getElementById('result').innerHTML += `<p>formatTime结果: <strong>${formatted}</strong></p>`;
    </script>
</body>
</html>