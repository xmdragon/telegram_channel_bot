<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Telegramæ¶ˆæ¯å®¡æ ¸ç³»ç»Ÿ</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸš€</text></svg>">
    
    <!-- å¤–éƒ¨æ ·å¼æ–‡ä»¶ -->
    <link rel="stylesheet" href="assets/css/element-plus.css">
    <link rel="stylesheet" href="assets/css/starcraft.css">
    <link rel="stylesheet" href="assets/css/main.css">
    <link rel="stylesheet" href="assets/css/components/index.css">
    
    <!-- å¤–éƒ¨è„šæœ¬æ–‡ä»¶ -->
    <script src="assets/js/vue.prod.js"></script>
    <script src="assets/js/element-plus.js"></script>
    <script src="assets/js/axios.js"></script>
    <script src="assets/js/components/index.js"></script>
</head>
<body>
    <div id="app">
        <div class="header">
            <h1>ğŸš€ TELEGRAM æ¶ˆæ¯å®¡æ ¸ç³»ç»Ÿ</h1>
            <p>æ™ºèƒ½é‡‡é›† Â· é«˜æ•ˆå®¡æ ¸ Â· è‡ªåŠ¨è½¬å‘</p>
        </div>

        <!-- å¯¼èˆªæ  -->
        <div class="nav-bar">
            <div class="nav-links">
                <a href="/" class="nav-link active">ğŸ  ä¸»æ§åˆ¶å°</a>
                <a href="/config" class="nav-link">âš™ï¸ ç³»ç»Ÿé…ç½®</a>
                <a href="/status" class="nav-link">ğŸ“Š ç³»ç»ŸçŠ¶æ€</a>
                <a href="/auth" class="nav-link">ğŸ” Telegramç™»å½•</a>
            </div>
            <div class="nav-links">
                <span style="color: #7fdbff; font-weight: 700;">ç³»ç»ŸçŠ¶æ€: {{ systemStatus }}</span>
            </div>
        </div>

        <div class="stats-container">
            <!-- ç»Ÿè®¡é¢æ¿ -->
            <el-row :gutter="20" class="stats-card">
                <el-col :span="4" v-for="(stat, key) in stats" :key="key">
                    <el-card class="stat-card" @click="handleStatClick(key)" :class="key">
                        <div class="stat-value">{{ stat.value }}</div>
                        <div class="stat-label">{{ stat.label }}</div>
                        <div class="stat-hint">ç‚¹å‡»æŸ¥çœ‹è¯¦æƒ…</div>
                    </el-card>
                </el-col>
            </el-row>

            <!-- å·¥å…·æ  -->
            <div class="toolbar">
                <div class="filter-group">
                    <el-select v-model="filters.status" placeholder="çŠ¶æ€ç­›é€‰" clearable @change="loadMessages">
                        <el-option label="å¾…å®¡æ ¸" value="pending"></el-option>
                        <el-option label="å·²æ‰¹å‡†" value="approved"></el-option>
                        <el-option label="å·²æ‹’ç»" value="rejected"></el-option>
                        <el-option label="è‡ªåŠ¨è½¬å‘" value="auto_forwarded"></el-option>
                    </el-select>
                    
                    <el-select v-model="filters.is_ad" placeholder="å¹¿å‘Šç­›é€‰" clearable @change="loadMessages">
                        <el-option label="å¹¿å‘Šæ¶ˆæ¯" :value="true"></el-option>
                        <el-option label="æ­£å¸¸æ¶ˆæ¯" :value="false"></el-option>
                    </el-select>
                    
                    <el-button @click="loadMessages" icon="Refresh">åˆ·æ–°æ•°æ®</el-button>
                </div>
                
                <div class="action-group">
                    <el-button 
                        type="success" 
                        @click="batchApprove" 
                        :disabled="selectedMessages.length === 0"
                        icon="Check">
                        æ‰¹é‡æ‰¹å‡† ({{ selectedMessages.length }})
                    </el-button>
                </div>
            </div>

            <!-- æ¶ˆæ¯åˆ—è¡¨ -->
            <div v-for="message in messages" :key="message.id" class="message-card" 
                 :class="[message.is_ad ? 'ad' : '', message.status]">
                <el-card>
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                        <div>
                            <strong style="color: #00ff41;">{{ message.source_channel }}</strong>
                            <span style="color: #7fdbff; margin-left: 10px;">#{{ message.message_id }}</span>
                        </div>
                        <div>
                            <el-tag :type="getStatusType(message.status)" size="small">
                                {{ getStatusText(message.status) }}
                            </el-tag>
                            <el-tag v-if="message.is_ad" type="danger" size="small" style="margin-left: 5px;">
                                å¹¿å‘Š
                            </el-tag>
                        </div>
                    </div>
                    
                    <div class="content-preview">
                        {{ message.content || 'æ— æ–‡æœ¬å†…å®¹' }}
                    </div>
                    
                    <div style="margin-top: 15px; display: flex; justify-content: space-between; align-items: center;">
                        <div style="color: #7fdbff; font-size: 12px;">
                            {{ formatTime(message.created_at) }}
                        </div>
                        <div>
                            <el-button 
                                v-if="message.status === 'pending'"
                                type="success" 
                                size="small" 
                                @click="approveMessage(message.id)"
                                icon="Check">
                                æ‰¹å‡†
                            </el-button>
                            <el-button 
                                v-if="message.status === 'pending'"
                                type="danger" 
                                size="small" 
                                @click="rejectMessage(message.id)"
                                icon="Close">
                                æ‹’ç»
                            </el-button>
                            <el-checkbox 
                                v-model="selectedMessages" 
                                :label="message.id"
                                style="margin-left: 10px;">
                            </el-checkbox>
                        </div>
                    </div>
                </el-card>
            </div>
        </div>
        
        <!-- çŠ¶æ€æ¶ˆæ¯ -->
        <div v-if="statusMessage" class="status-message" :class="statusType">
            {{ statusMessage }}
        </div>
        
        <!-- åŠ è½½é®ç½© -->
        <div v-if="loading" class="loading-overlay">
            <div class="loading-content">
                <div class="loading-spinner"></div>
                <p style="margin-top: 15px; color: #00ff41;">{{ loadingMessage }}</p>
            </div>
        </div>
    </div>

    <script>
        // ä½¿ç”¨å¤–éƒ¨ç»„ä»¶
        createApp(MainApp).use(ElementPlus).mount('#app');
    </script>
</body>
</html>