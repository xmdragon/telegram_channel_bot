<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç³»ç»Ÿé…ç½® - Telegramæ¶ˆæ¯å®¡æ ¸ç³»ç»Ÿ</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>âš™ï¸</text></svg>">
    
    <!-- å¤–éƒ¨æ ·å¼æ–‡ä»¶ -->
    <link rel="stylesheet" href="assets/css/element-plus.css">
    <link rel="stylesheet" href="assets/css/main.css">
    <link rel="stylesheet" href="assets/css/starcraft.css">
    <link rel="stylesheet" href="assets/css/components/config.css">
    
    <!-- å¤–éƒ¨è„šæœ¬æ–‡ä»¶ -->
    <script src="assets/js/vue.prod.js"></script>
    <script src="assets/js/element-plus.js"></script>
    <script src="assets/js/axios.js"></script>
    <script src="assets/js/components/config.js"></script>
</head>
<body>
    <div id="app">
        <div class="header">
            <h1>âš™ï¸ ç³»ç»Ÿé…ç½®ä¸­å¿ƒ</h1>
            <p>é¢‘é“ç®¡ç† Â· è¿‡æ»¤è§„åˆ™ Â· è½¬å‘è®¾ç½®</p>
        </div>

        <!-- å¯¼èˆªæ  -->
        <div class="nav-bar">
            <div class="nav-links">
                <a href="/" class="nav-link">ğŸ  ä¸»æ§åˆ¶å°</a>
                <a href="/config" class="nav-link active">âš™ï¸ ç³»ç»Ÿé…ç½®</a>
                <a href="/status" class="nav-link">ğŸ“Š ç³»ç»ŸçŠ¶æ€</a>
                <a href="/auth" class="nav-link">ğŸ” Telegramç™»å½•</a>
            </div>
            <div class="nav-links">
                <span style="color: #7fdbff; font-weight: 700;">é…ç½®çŠ¶æ€: {{ configStatus }}</span>
            </div>
        </div>

        <div class="container">
            <!-- é…ç½®æ ‡ç­¾é¡µ -->
            <el-tabs v-model="activeTab" type="border-card" class="config-tabs">
                <!-- é¢‘é“ç®¡ç† -->
                <el-tab-pane label="ğŸ“¡ é¢‘é“ç®¡ç†" name="channels">
                    <div class="config-section">
                        <h3>ç›‘å¬é¢‘é“åˆ—è¡¨</h3>
                        <div class="channel-list">
                            <div v-for="channel in channels" :key="channel.id" class="channel-item">
                                <div class="channel-info">
                                    <strong>{{ channel.name && channel.name.startsWith('@') ? channel.name : '@' + (channel.name || '') }}</strong>
                                    <span class="channel-id">{{ channel.title }}</span>
                                </div>
                                <div class="channel-actions">
                                    <el-tag 
                                        :type="channel.status === 'active' ? 'success' : 'danger'" 
                                        size="small"
                                        style="cursor: pointer;"
                                        @click="toggleChannelStatus(channel)">
                                        {{ channel.status === 'active' ? 'æ´»è·ƒ' : 'åœç”¨' }}
                                    </el-tag>
                                    <el-button size="small" type="danger" @click="removeChannel(channel.name)">
                                        åˆ é™¤
                                    </el-button>
                                </div>
                            </div>
                        </div>
                        
                        <div class="add-channel-form">
                            <h4>æ·»åŠ æ–°é¢‘é“</h4>
                            <el-form :model="newChannel" label-width="100px">
                                <el-form-item label="é¢‘é“åç§°">
                                    <el-input v-model="newChannel.name" placeholder="è¾“å…¥é¢‘é“åç§°"></el-input>
                                </el-form-item>
                                <el-form-item label="é¢‘é“æ ‡é¢˜">
                                    <el-input v-model="newChannel.title" placeholder="è¾“å…¥é¢‘é“æ ‡é¢˜"></el-input>
                                </el-form-item>
                                <el-form-item>
                                    <el-button type="primary" @click="addChannel">æ·»åŠ é¢‘é“</el-button>
                                </el-form-item>
                            </el-form>
                        </div>
                    </div>
                </el-tab-pane>

                <!-- è¿‡æ»¤è§„åˆ™ -->
                <el-tab-pane label="ğŸ›¡ï¸ è¿‡æ»¤è§„åˆ™" name="filters">
                    <div class="config-section">
                        <h3>å†…å®¹è¿‡æ»¤è§„åˆ™</h3>
                        <div class="filter-rules">
                            <div v-for="rule in filterRules" :key="rule.id" class="rule-item">
                                <div class="rule-info">
                                    <strong>{{ rule.name }}</strong>
                                    <span class="rule-pattern">{{ rule.pattern }}</span>
                                </div>
                                <div class="rule-actions">
                                    <el-tag :type="rule.action === 'block' ? 'danger' : 'warning'" size="small">
                                        {{ rule.action === 'block' ? 'é˜»æ­¢' : 'æ ‡è®°' }}
                                    </el-tag>
                                    <el-button size="small" type="danger" @click="removeRule(rule.id)">
                                        åˆ é™¤
                                    </el-button>
                                </div>
                            </div>
                        </div>
                        
                        <div class="add-rule-form">
                            <h4>æ·»åŠ æ–°è§„åˆ™</h4>
                            <el-form :model="newRule" label-width="100px">
                                <el-form-item label="è§„åˆ™åç§°">
                                    <el-input v-model="newRule.name" placeholder="è¾“å…¥è§„åˆ™åç§°"></el-input>
                                </el-form-item>
                                <el-form-item label="åŒ¹é…æ¨¡å¼">
                                    <el-input v-model="newRule.pattern" placeholder="è¾“å…¥æ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼"></el-input>
                                </el-form-item>
                                <el-form-item label="æ‰§è¡ŒåŠ¨ä½œ">
                                    <el-select v-model="newRule.action" placeholder="é€‰æ‹©åŠ¨ä½œ">
                                        <el-option label="é˜»æ­¢æ¶ˆæ¯" value="block"></el-option>
                                        <el-option label="æ ‡è®°ä¸ºå¹¿å‘Š" value="mark_ad"></el-option>
                                    </el-select>
                                </el-form-item>
                                <el-form-item>
                                    <el-button type="primary" @click="addRule">æ·»åŠ è§„åˆ™</el-button>
                                </el-form-item>
                            </el-form>
                        </div>
                    </div>
                </el-tab-pane>

                <!-- è½¬å‘è®¾ç½® -->
                <el-tab-pane label="ğŸ“¤ è½¬å‘è®¾ç½®" name="forwarding">
                    <div class="config-section">
                        <h3>è‡ªåŠ¨è½¬å‘é…ç½®</h3>
                        <el-form :model="forwardingConfig" label-width="150px">
                            <el-form-item label="å¯ç”¨è‡ªåŠ¨è½¬å‘">
                                <el-switch v-model="forwardingConfig.enabled"></el-switch>
                            </el-form-item>
                            <el-form-item label="ç›®æ ‡é¢‘é“">
                                <el-input v-model="forwardingConfig.target_channel" placeholder="è¾“å…¥ç›®æ ‡é¢‘é“åç§°ï¼ˆæ”¯æŒå¸¦@æˆ–ä¸å¸¦@ï¼‰"></el-input>
                            </el-form-item>
                            <el-form-item label="è½¬å‘å»¶è¿Ÿï¼ˆç§’ï¼‰">
                                <el-input-number v-model="forwardingConfig.delay" :min="0" :max="3600"></el-input-number>
                            </el-form-item>
                            <el-form-item label="è½¬å‘æ¡ä»¶">
                                <el-checkbox-group v-model="forwardingConfig.conditions">
                                    <el-checkbox label="approved">å·²æ‰¹å‡†æ¶ˆæ¯</el-checkbox>
                                    <el-checkbox label="auto_approved">è‡ªåŠ¨æ‰¹å‡†æ¶ˆæ¯</el-checkbox>
                                </el-checkbox-group>
                            </el-form-item>
                            <el-form-item>
                                <el-button type="primary" @click="saveForwardingConfig">ä¿å­˜é…ç½®</el-button>
                            </el-form-item>
                        </el-form>
                    </div>
                </el-tab-pane>

                <!-- ç³»ç»Ÿè®¾ç½® -->
                <el-tab-pane label="ğŸ”§ ç³»ç»Ÿè®¾ç½®" name="system">
                    <div class="config-section">
                        <h3>ç³»ç»Ÿå‚æ•°é…ç½®</h3>
                        <el-form :model="systemConfig" label-width="150px">
                            <el-form-item label="å®¡æ ¸æ¨¡å¼">
                                <el-radio-group v-model="systemConfig.review_mode">
                                    <el-radio label="manual">æ‰‹åŠ¨å®¡æ ¸</el-radio>
                                    <el-radio label="auto">è‡ªåŠ¨å®¡æ ¸</el-radio>
                                    <el-radio label="hybrid">æ··åˆæ¨¡å¼</el-radio>
                                </el-radio-group>
                            </el-form-item>
                            <el-form-item label="æ¶ˆæ¯ä¿ç•™å¤©æ•°">
                                <el-input-number v-model="systemConfig.retention_days" :min="1" :max="365"></el-input-number>
                            </el-form-item>
                            <el-form-item label="æœ€å¤§å¹¶å‘æ•°">
                                <el-input-number v-model="systemConfig.max_concurrent" :min="1" :max="100"></el-input-number>
                            </el-form-item>
                            <el-form-item label="æ—¥å¿—çº§åˆ«">
                                <el-select v-model="systemConfig.log_level">
                                    <el-option label="DEBUG" value="debug"></el-option>
                                    <el-option label="INFO" value="info"></el-option>
                                    <el-option label="WARNING" value="warning"></el-option>
                                    <el-option label="ERROR" value="error"></el-option>
                                </el-select>
                            </el-form-item>
                            <el-form-item label="å†å²æ¶ˆæ¯é‡‡é›†æ•°">
                                <el-input-number v-model="systemConfig.history_message_limit" :min="1" :max="1000" placeholder="50"></el-input-number>
                                <div style="font-size: 12px; color: #999; margin-top: 5px;">
                                    é¦–æ¬¡é‡‡é›†æˆ–é‡å¯åä»é¢‘é“è·å–çš„å†å²æ¶ˆæ¯æ¡æ•°
                                </div>
                            </el-form-item>
                            <el-form-item>
                                <el-button type="primary" @click="saveSystemConfig">ä¿å­˜é…ç½®</el-button>
                                <el-button @click="resetSystemConfig">é‡ç½®é»˜è®¤</el-button>
                            </el-form-item>
                        </el-form>
                    </div>
                </el-tab-pane>
            </el-tabs>
        </div>
        
        <!-- çŠ¶æ€æ¶ˆæ¯ -->
        <div v-if="statusMessage" class="status-message" :class="statusType">
            {{ statusMessage }}
        </div>
        
        <!-- åŠ è½½é®ç½© -->
        <div v-if="loading" class="loading-overlay">
            <div class="loading-content">
                <div class="loading-spinner"></div>
                <p>{{ loadingMessage }}</p>
            </div>
        </div>
    </div>
</body>
</html> 